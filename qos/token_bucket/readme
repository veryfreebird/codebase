source: https://blog.csdn.net/andylau00j/article/details/73958599
source: https://www.cnblogs.com/f-zhao/p/7210158.html
https://cloud.tencent.com/developer/article/1408819
https://cloud.tencent.com/developer/article/1462630

漏桶(Leaky bucket)与令牌桶(Token bucket)算法有什么区别。

令牌桶，初始令牌个数是0，最大容量是100，当1万个请求到来时(初始令牌个数是0时)，也只能一秒处理一个请求个，因为令牌是每秒产生一个。

漏桶，初始流量是0，最大流量是100，当1万个请求到来时，可以迅速的，最多的，能同时处理100个。

=============================================

令牌桶，初始令牌个数是100，最大容量是100，当1万个请求到来时(初始令牌个数是0时)，可以迅速的，最多的，同时处理100个请求，从第101个请求开始，也只能等新令牌的产生，而令牌是每秒产生一个。
漏桶，初始流量是0，最大流量是100，当1万个请求到来时，可以迅速的，最多的，能同时处理100个。

Google Guava RateLimiter类，是一个基于令牌桶的限流算法。


How to run:
javac -cp ./lib/guava-28.1-jre.jar:${CLASSPATH} TestRateLimiter.java
java -cp ./lib/guava-28.1-jre.jar:${CLASSPATH} TestRateLimiter

令牌桶和漏桶对比：
令牌桶是按照固定速率往桶中添加令牌，请求是否被处理需要看桶中令牌是否足够，当令牌数减为零时则拒绝新的请求；
漏桶则是按照常量固定速率流出请求，流入请求速率任意，当流入的请求数累积到漏桶容量时，则新流入的请求被拒绝；
令牌桶限制的是平均流入速率，允许突发请求，只要有令牌就可以处理，支持一次拿3个令牌，4个令牌；
漏桶限制的是常量流出速率，即流出速率是一个固定常量值，比如都是1的速率流出，而不能一次是1，下次又是2，从而平滑突发流入速率；
令牌桶允许一定程度的突发，而漏桶主要目的是平滑流出速率；